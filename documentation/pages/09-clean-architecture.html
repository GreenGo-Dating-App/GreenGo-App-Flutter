<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clean Architecture - GreenGo Documentation</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <span class="logo-icon">ğŸŒ¿</span>
                <a href="../index.html" class="logo-text" style="text-decoration: none; color: #D4AF37;">GreenGo</a>
            </div>
        </div>
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Search...">
        </div>
        
        
        <ul class="nav-menu" id="navMenu">
            <!-- 1. Project Overview -->
            <li class="nav-section">
                <div class="nav-section-title" data-section="overview">
                    <i class="fas fa-home"></i>
                    <span>Project Overview</span>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <ul class="nav-submenu">
                    <li><a href="01-introduction.html">1. Project Introduction</a></li>
                    <li><a href="02-tech-stack.html">2. Technology Stack</a></li>
                    <li><a href="03-repository-structure.html">3. Repository Structure</a></li>
                    <li><a href="04-version-history.html">4. Version History</a></li>
                    <li><a href="05-getting-started.html">5. Getting Started</a></li>
                    <li><a href="06-dev-environment.html">6. Development Environment</a></li>
                    <li><a href="07-quick-start.html">7. Quick Start Tutorial</a></li>
                    <li><a href="08-glossary.html">8. Glossary & Terminology</a></li>
                </ul>
            </li>

            <!-- 2. Architecture -->
            <li class="nav-section">
                <div class="nav-section-title" data-section="architecture">
                    <i class="fas fa-sitemap"></i>
                    <span>Architecture</span>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <ul class="nav-submenu">
                    <li><a href="09-clean-architecture.html">9. Clean Architecture</a></li>
                    <li><a href="10-feature-modules.html">10. Feature Modules</a></li>
                    <li><a href="11-state-management.html">11. State Management (BLoC)</a></li>
                    <li><a href="12-dependency-injection.html">12. Dependency Injection</a></li>
                    <li><a href="13-repository-pattern.html">13. Repository Pattern</a></li>
                    <li><a href="14-data-flow.html">14. Data Flow Diagram</a></li>
                    <li><a href="15-error-handling.html">15. Error Handling</a></li>
                    <li><a href="16-navigation.html">16. Navigation & Routing</a></li>
                    <li><a href="17-api-layer.html">17. API & Network Layer</a></li>
                    <li><a href="18-caching.html">18. Caching Strategy</a></li>
                    <li><a href="19-real-time.html">19. Real-time Communication</a></li>
                    <li><a href="20-testing-architecture.html">20. Testing Architecture</a></li>
                </ul>
            </li>

            <!-- 3. Design System -->
            <li class="nav-section">
                <div class="nav-section-title" data-section="design">
                    <i class="fas fa-palette"></i>
                    <span>Design System</span>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <ul class="nav-submenu">
                    <li><a href="21-brand-guidelines.html">21. Brand Guidelines</a></li>
                    <li><a href="22-color-palette.html">22. Color Palette</a></li>
                    <li><a href="23-typography.html">23. Typography System</a></li>
                    <li><a href="24-spacing.html">24. Spacing & Dimensions</a></li>
                    <li><a href="25-components.html">25. Component Library</a></li>
                    <li><a href="26-icons.html">26. Icon System</a></li>
                    <li><a href="27-animations.html">27. Animation Guidelines</a></li>
                    <li><a href="28-theming.html">28. Dark/Light Theme</a></li>
                    <li><a href="29-responsive.html">29. Responsive Design</a></li>
                    <li><a href="30-accessibility.html">30. Accessibility Guidelines</a></li>
                </ul>
            </li>

            <!-- 4. Core Features -->
            <li class="nav-section">
                <div class="nav-section-title" data-section="features">
                    <i class="fas fa-puzzle-piece"></i>
                    <span>Core Features</span>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <ul class="nav-submenu">
                    <li><a href="31-auth-flow.html">31. Authentication Flow</a></li>
                    <li><a href="32-social-auth.html">32. Social Authentication</a></li>
                    <li><a href="33-biometric-auth.html">33. Biometric Authentication</a></li>
                    <li><a href="34-onboarding.html">34. Profile Onboarding</a></li>
                    <li><a href="35-photo-upload.html">35. Photo Management</a></li>
                    <li><a href="36-profile-editing.html">36. Profile Editing</a></li>
                    <li><a href="37-matching-algorithm.html">37. Matching Algorithm</a></li>
                    <li><a href="38-discovery.html">38. Discovery Interface</a></li>
                    <li><a href="39-like-actions.html">39. Like/Pass Actions</a></li>
                    <li><a href="40-match-system.html">40. Match System</a></li>
                    <li><a href="41-chat.html">41. Real-time Chat</a></li>
                    <li><a href="42-message-features.html">42. Message Features</a></li>
                    <li><a href="43-push-notifications.html">43. Push Notifications</a></li>
                    <li><a href="44-in-app-notifications.html">44. In-App Notifications</a></li>
                    <li><a href="45-subscriptions.html">45. Subscription Tiers</a></li>
                    <li><a href="46-in-app-purchases.html">46. In-App Purchases</a></li>
                    <li><a href="47-coins.html">47. Virtual Currency</a></li>
                    <li><a href="48-gamification.html">48. Gamification System</a></li>
                    <li><a href="49-challenges.html">49. Daily Challenges</a></li>
                    <li><a href="50-leaderboards.html">50. Leaderboards</a></li>
                </ul>
            </li>

            <!-- 5. Backend Services -->
            <li class="nav-section">
                <div class="nav-section-title" data-section="backend">
                    <i class="fas fa-server"></i>
                    <span>Backend Services</span>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <ul class="nav-submenu">
                    <li><a href="51-firebase-overview.html">51. Firebase Overview</a></li>
                    <li><a href="52-firestore.html">52. Firestore Database</a></li>
                    <li><a href="53-firebase-auth.html">53. Firebase Authentication</a></li>
                    <li><a href="54-firebase-storage.html">54. Firebase Storage</a></li>
                    <li><a href="55-cloud-functions.html">55. Cloud Functions</a></li>
                    <li><a href="56-django-backend.html">56. Django Backend</a></li>
                    <li><a href="57-api-documentation.html">57. API Documentation</a></li>
                    <li><a href="58-realtime-sync.html">58. Real-time Sync</a></li>
                    <li><a href="59-background-processing.html">59. Background Processing</a></li>
                    <li><a href="60-rate-limiting.html">60. Rate Limiting</a></li>
                </ul>
            </li>

            <!-- 6. Database -->
            <li class="nav-section">
                <div class="nav-section-title" data-section="database">
                    <i class="fas fa-database"></i>
                    <span>Database</span>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <ul class="nav-submenu">
                    <li><a href="61-firestore-schema.html">61. Firestore Schema</a></li>
                    <li><a href="62-postgresql-schema.html">62. PostgreSQL Schema</a></li>
                    <li><a href="63-data-migration.html">63. Data Migration</a></li>
                    <li><a href="64-indexing.html">64. Indexing Strategy</a></li>
                    <li><a href="65-backup-recovery.html">65. Backup & Recovery</a></li>
                    <li><a href="66-data-retention.html">66. Data Retention Policy</a></li>
                    <li><a href="67-redis-caching.html">67. Redis Caching</a></li>
                    <li><a href="68-bigquery.html">68. BigQuery Analytics</a></li>
                </ul>
            </li>

            <!-- 7. Security -->
            <li class="nav-section">
                <div class="nav-section-title" data-section="security">
                    <i class="fas fa-shield-alt"></i>
                    <span>Security</span>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <ul class="nav-submenu">
                    <li><a href="69-security-architecture.html">69. Security Architecture</a></li>
                    <li><a href="70-firestore-rules.html">70. Firestore Rules</a></li>
                    <li><a href="71-storage-rules.html">71. Storage Rules</a></li>
                    <li><a href="72-auth-security.html">72. Authentication Security</a></li>
                    <li><a href="73-encryption.html">73. Data Encryption</a></li>
                    <li><a href="74-app-check.html">74. App Check</a></li>
                    <li><a href="75-content-moderation.html">75. Content Moderation</a></li>
                    <li><a href="76-spam-detection.html">76. Spam Detection</a></li>
                    <li><a href="77-reporting-system.html">77. Reporting System</a></li>
                    <li><a href="78-security-audit.html">78. Security Audit</a></li>
                </ul>
            </li>

            <!-- 8. Third-Party Integrations -->
            <li class="nav-section">
                <div class="nav-section-title" data-section="integrations">
                    <i class="fas fa-plug"></i>
                    <span>Integrations</span>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <ul class="nav-submenu">
                    <li><a href="79-agora-video.html">79. Agora Video Calling</a></li>
                    <li><a href="80-stripe.html">80. Stripe Payments</a></li>
                    <li><a href="81-sendgrid.html">81. SendGrid Email</a></li>
                    <li><a href="82-twilio.html">82. Twilio SMS</a></li>
                    <li><a href="83-google-maps.html">83. Google Maps</a></li>
                    <li><a href="84-google-cloud-ai.html">84. Google Cloud AI</a></li>
                    <li><a href="85-mixpanel.html">85. Mixpanel Analytics</a></li>
                    <li><a href="86-sentry.html">86. Sentry Tracking</a></li>
                    <li><a href="87-perspective-api.html">87. Perspective API</a></li>
                    <li><a href="88-revenuecat.html">88. RevenueCat</a></li>
                </ul>
            </li>

            <!-- 9. DevOps -->
            <li class="nav-section">
                <div class="nav-section-title" data-section="devops">
                    <i class="fas fa-cogs"></i>
                    <span>DevOps</span>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <ul class="nav-submenu">
                    <li><a href="89-terraform.html">89. Terraform Infrastructure</a></li>
                    <li><a href="90-docker.html">90. Docker Development</a></li>
                    <li><a href="91-cicd.html">91. CI/CD Pipeline</a></li>
                    <li><a href="92-environments.html">92. Environment Management</a></li>
                    <li><a href="93-feature-flags.html">93. Feature Flags</a></li>
                    <li><a href="94-pre-commit.html">94. Pre-commit Hooks</a></li>
                    <li><a href="95-deployment.html">95. Deployment Scripts</a></li>
                    <li><a href="96-firebase-hosting.html">96. Firebase Hosting</a></li>
                </ul>
            </li>

            <!-- 10. Testing -->
            <li class="nav-section">
                <div class="nav-section-title" data-section="testing">
                    <i class="fas fa-vial"></i>
                    <span>Testing</span>
                    <i class="fas fa-chevron-down arrow"></i>
                </div>
                <ul class="nav-submenu">
                    <li><a href="97-unit-testing.html">97. Unit Testing</a></li>
                    <li><a href="98-widget-testing.html">98. Widget Testing</a></li>
                    <li><a href="99-integration-testing.html">99. Integration Testing</a></li>
                    <li><a href="100-firebase-test-lab.html">100. Firebase Test Lab</a></li>
                </ul>
            </li>
        </ul>
    </nav>

    <main class="main-content">
        <header class="top-header">
            <button class="mobile-menu-toggle" id="mobileMenuToggle"><i class="fas fa-bars"></i></button>
            <div class="header-title"><h1>Clean Architecture</h1></div>
        </header>

        <div class="content-wrapper">
            <div class="page-header">
                <div class="breadcrumb">
                    <a href="../index.html">Home</a> / <a href="#">Architecture</a> / Clean Architecture
                </div>
            </div>

            <div class="page-content">
                
            <h2>Clean Architecture Overview</h2>
            <p>GreenGo implements Uncle Bob's Clean Architecture to achieve separation of concerns, testability, and independence from frameworks. This architecture ensures the business logic remains isolated and the codebase scales efficiently.</p>

            <div class="info-box">
                <strong>Key Principle:</strong> Dependencies always point inward. The inner layers know nothing about outer layers.
            </div>

            <h2>Architecture Layers Diagram</h2>
            <pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRESENTATION LAYER                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Screens   â”‚  â”‚   Widgets   â”‚  â”‚    BLoCs    â”‚              â”‚
â”‚  â”‚   (Pages)   â”‚  â”‚ (Components)â”‚  â”‚   (State)   â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚         â”‚                â”‚                â”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                          â”‚                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          â–¼                                       â”‚
â”‚                    DOMAIN LAYER                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Entities   â”‚  â”‚  Use Cases  â”‚  â”‚ Repository  â”‚              â”‚
â”‚  â”‚  (Models)   â”‚  â”‚  (Interac.) â”‚  â”‚ (Abstract)  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                          â”‚                â”‚                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          â–¼                â–¼                      â”‚
â”‚                      DATA LAYER                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Models    â”‚  â”‚ Repository  â”‚  â”‚ DataSources â”‚              â”‚
â”‚  â”‚   (DTOs)    â”‚  â”‚   (Impl)    â”‚  â”‚(Remote/Local)â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                          â”‚                â”‚                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          â–¼                â–¼                      â”‚
â”‚                 EXTERNAL SERVICES                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Firebase   â”‚  â”‚   REST API  â”‚  â”‚Local Storageâ”‚              â”‚
â”‚  â”‚  Services   â”‚  â”‚   (Django)  â”‚  â”‚(Hive/Prefs) â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <h2>Dependency Flow</h2>
            <pre><code>
    OUTER                                              INNER
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   UI     â”‚â”€â”€â”€â–¶â”‚   BLoC   â”‚â”€â”€â”€â–¶â”‚ Use Case â”‚â”€â”€â”€â–¶â”‚  Entity  â”‚
    â”‚(Widgets) â”‚    â”‚ (State)  â”‚    â”‚(Business)â”‚    â”‚ (Core)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚               â”‚
         â”‚               â”‚               â–¼
         â”‚               â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚         â”‚Repositoryâ”‚
         â”‚               â”‚         â”‚(Abstract)â”‚
         â”‚               â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚               â–²
         â”‚               â–¼               â”‚
         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚         â”‚Repositoryâ”‚â”€â”€â”€â–¶â”‚DataSourceâ”‚
         â”‚         â”‚  (Impl)  â”‚    â”‚ (Remote) â”‚
         â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚
         â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    External Services    â”‚
    â”‚  (Firebase, APIs, DB)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <h2>Layer Responsibilities</h2>

            <h3>1. Presentation Layer</h3>
            <table>
                <tr><th>Component</th><th>Responsibility</th><th>Dependencies</th></tr>
                <tr>
                    <td><strong>Screens</strong></td>
                    <td>Display UI, handle user interactions</td>
                    <td>BLoC, Widgets</td>
                </tr>
                <tr>
                    <td><strong>Widgets</strong></td>
                    <td>Reusable UI components</td>
                    <td>Theme, Constants</td>
                </tr>
                <tr>
                    <td><strong>BLoC</strong></td>
                    <td>State management, UI logic</td>
                    <td>Use Cases, Entities</td>
                </tr>
            </table>

            <h3>2. Domain Layer (Core)</h3>
            <table>
                <tr><th>Component</th><th>Responsibility</th><th>Dependencies</th></tr>
                <tr>
                    <td><strong>Entities</strong></td>
                    <td>Core business objects</td>
                    <td>None (pure Dart)</td>
                </tr>
                <tr>
                    <td><strong>Use Cases</strong></td>
                    <td>Business logic operations</td>
                    <td>Entities, Repository (abstract)</td>
                </tr>
                <tr>
                    <td><strong>Repository (Abstract)</strong></td>
                    <td>Data operation contracts</td>
                    <td>Entities</td>
                </tr>
            </table>

            <h3>3. Data Layer</h3>
            <table>
                <tr><th>Component</th><th>Responsibility</th><th>Dependencies</th></tr>
                <tr>
                    <td><strong>Models</strong></td>
                    <td>Data transfer objects with serialization</td>
                    <td>Entities</td>
                </tr>
                <tr>
                    <td><strong>Repository (Impl)</strong></td>
                    <td>Implements abstract repository</td>
                    <td>DataSources, Models</td>
                </tr>
                <tr>
                    <td><strong>DataSources</strong></td>
                    <td>Fetches data from external sources</td>
                    <td>External APIs, Firebase, Local DB</td>
                </tr>
            </table>

            <h2>Request-Response Flow</h2>
            <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Event    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Params   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UI    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚  BLoC   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚Use Case â”‚
â”‚ Screen  â”‚            â”‚         â”‚           â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                                                  â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚Abstract â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚Repositoryâ”‚
                       â”‚  Repo   â”‚           â”‚   Impl   â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚  Remote  â”‚ â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚ Firebase â”‚
                       â”‚DataSourceâ”‚          â”‚   API    â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ JSON Response
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   State    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Entity   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UI    â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  BLoC   â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  Model  â”‚
â”‚ Screen  â”‚            â”‚         â”‚           â”‚  Parse  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

            <h2>File Organization</h2>
            <pre><code>lib/
â”œâ”€â”€ core/                           # Shared across features
â”‚   â”œâ”€â”€ errors/
â”‚   â”‚   â”œâ”€â”€ failures.dart           # Domain failures
â”‚   â”‚   â””â”€â”€ exceptions.dart         # Data exceptions
â”‚   â”œâ”€â”€ usecases/
â”‚   â”‚   â””â”€â”€ usecase.dart            # Base use case class
â”‚   â”œâ”€â”€ network/
â”‚   â”‚   â””â”€â”€ network_info.dart       # Connectivity checker
â”‚   â””â”€â”€ di/
â”‚       â””â”€â”€ injection_container.dart # Dependency injection
â”‚
â””â”€â”€ features/
    â””â”€â”€ [feature_name]/
        â”œâ”€â”€ domain/                 # INNER LAYER
        â”‚   â”œâ”€â”€ entities/           # Business objects
        â”‚   â”œâ”€â”€ repositories/       # Abstract contracts
        â”‚   â””â”€â”€ usecases/           # Business logic
        â”‚
        â”œâ”€â”€ data/                   # MIDDLE LAYER
        â”‚   â”œâ”€â”€ models/             # DTOs
        â”‚   â”œâ”€â”€ repositories/       # Implementations
        â”‚   â””â”€â”€ datasources/        # API calls
        â”‚
        â””â”€â”€ presentation/           # OUTER LAYER
            â”œâ”€â”€ bloc/               # State management
            â”œâ”€â”€ screens/            # UI pages
            â””â”€â”€ widgets/            # UI components</code></pre>

            <h2>Implementation Example: User Feature</h2>

            <h3>Step 1: Define Entity (Domain Layer)</h3>
            <pre><code>// lib/features/profile/domain/entities/user.dart

import 'package:equatable/equatable.dart';

class User extends Equatable {
  final String id;
  final String email;
  final String name;
  final String? photoUrl;
  final DateTime createdAt;
  final bool isVerified;

  const User({
    required this.id,
    required this.email,
    required this.name,
    this.photoUrl,
    required this.createdAt,
    required this.isVerified,
  });

  // Business logic methods
  bool get hasCompletedProfile => name.isNotEmpty && photoUrl != null;

  int get accountAgeInDays => DateTime.now().difference(createdAt).inDays;

  @override
  List<Object?> get props => [id, email, name, photoUrl, createdAt, isVerified];
}</code></pre>

            <h3>Step 2: Define Repository Contract (Domain Layer)</h3>
            <pre><code>// lib/features/profile/domain/repositories/user_repository.dart

import 'package:dartz/dartz.dart';
import '../entities/user.dart';
import '../../../../core/errors/failures.dart';

abstract class UserRepository {
  Future<Either<Failure, User>> getUser(String userId);
  Future<Either<Failure, User>> updateUser(User user);
  Future<Either<Failure, void>> deleteUser(String userId);
  Stream<User> watchUser(String userId);
}</code></pre>

            <h3>Step 3: Create Use Case (Domain Layer)</h3>
            <pre><code>// lib/features/profile/domain/usecases/get_user.dart

import 'package:dartz/dartz.dart';
import '../../../../core/usecases/usecase.dart';
import '../../../../core/errors/failures.dart';
import '../entities/user.dart';
import '../repositories/user_repository.dart';

class GetUser implements UseCase<User, String> {
  final UserRepository repository;

  GetUser(this.repository);

  @override
  Future<Either<Failure, User>> call(String userId) {
    return repository.getUser(userId);
  }
}</code></pre>

            <h3>Step 4: Create Model (Data Layer)</h3>
            <pre><code>// lib/features/profile/data/models/user_model.dart

import 'package:cloud_firestore/cloud_firestore.dart';
import '../../domain/entities/user.dart';

class UserModel extends User {
  const UserModel({
    required String id,
    required String email,
    required String name,
    String? photoUrl,
    required DateTime createdAt,
    required bool isVerified,
  }) : super(
          id: id,
          email: email,
          name: name,
          photoUrl: photoUrl,
          createdAt: createdAt,
          isVerified: isVerified,
        );

  factory UserModel.fromJson(Map<String, dynamic> json) {
    return UserModel(
      id: json['id'] as String,
      email: json['email'] as String,
      name: json['name'] as String,
      photoUrl: json['photoUrl'] as String?,
      createdAt: (json['createdAt'] as Timestamp).toDate(),
      isVerified: json['isVerified'] as bool? ?? false,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'email': email,
      'name': name,
      'photoUrl': photoUrl,
      'createdAt': Timestamp.fromDate(createdAt),
      'isVerified': isVerified,
    };
  }

  factory UserModel.fromEntity(User user) {
    return UserModel(
      id: user.id,
      email: user.email,
      name: user.name,
      photoUrl: user.photoUrl,
      createdAt: user.createdAt,
      isVerified: user.isVerified,
    );
  }
}</code></pre>

            <h3>Step 5: Implement DataSource (Data Layer)</h3>
            <pre><code>// lib/features/profile/data/datasources/user_remote_datasource.dart

import 'package:cloud_firestore/cloud_firestore.dart';
import '../models/user_model.dart';
import '../../../../core/errors/exceptions.dart';

abstract class UserRemoteDataSource {
  Future<UserModel> getUser(String userId);
  Future<UserModel> updateUser(UserModel user);
  Future<void> deleteUser(String userId);
  Stream<UserModel> watchUser(String userId);
}

class UserRemoteDataSourceImpl implements UserRemoteDataSource {
  final FirebaseFirestore firestore;

  UserRemoteDataSourceImpl(this.firestore);

  @override
  Future<UserModel> getUser(String userId) async {
    try {
      final doc = await firestore.collection('users').doc(userId).get();

      if (!doc.exists) {
        throw ServerException('User not found');
      }

      return UserModel.fromJson({...doc.data()!, 'id': doc.id});
    } on FirebaseException catch (e) {
      throw ServerException(e.message ?? 'Failed to get user');
    }
  }

  @override
  Future<UserModel> updateUser(UserModel user) async {
    try {
      await firestore.collection('users').doc(user.id).update(user.toJson());
      return user;
    } on FirebaseException catch (e) {
      throw ServerException(e.message ?? 'Failed to update user');
    }
  }

  @override
  Future<void> deleteUser(String userId) async {
    try {
      await firestore.collection('users').doc(userId).delete();
    } on FirebaseException catch (e) {
      throw ServerException(e.message ?? 'Failed to delete user');
    }
  }

  @override
  Stream<UserModel> watchUser(String userId) {
    return firestore
        .collection('users')
        .doc(userId)
        .snapshots()
        .map((doc) => UserModel.fromJson({...doc.data()!, 'id': doc.id}));
  }
}</code></pre>

            <h3>Step 6: Implement Repository (Data Layer)</h3>
            <pre><code>// lib/features/profile/data/repositories/user_repository_impl.dart

import 'package:dartz/dartz.dart';
import '../../domain/entities/user.dart';
import '../../domain/repositories/user_repository.dart';
import '../datasources/user_remote_datasource.dart';
import '../datasources/user_local_datasource.dart';
import '../models/user_model.dart';
import '../../../../core/errors/failures.dart';
import '../../../../core/errors/exceptions.dart';
import '../../../../core/network/network_info.dart';

class UserRepositoryImpl implements UserRepository {
  final UserRemoteDataSource remoteDataSource;
  final UserLocalDataSource localDataSource;
  final NetworkInfo networkInfo;

  UserRepositoryImpl({
    required this.remoteDataSource,
    required this.localDataSource,
    required this.networkInfo,
  });

  @override
  Future<Either<Failure, User>> getUser(String userId) async {
    if (await networkInfo.isConnected) {
      try {
        final remoteUser = await remoteDataSource.getUser(userId);
        await localDataSource.cacheUser(remoteUser);
        return Right(remoteUser);
      } on ServerException catch (e) {
        return Left(ServerFailure(e.message));
      }
    } else {
      try {
        final localUser = await localDataSource.getCachedUser(userId);
        return Right(localUser);
      } on CacheException {
        return Left(CacheFailure('No cached data available'));
      }
    }
  }

  @override
  Future<Either<Failure, User>> updateUser(User user) async {
    try {
      final userModel = UserModel.fromEntity(user);
      final updatedUser = await remoteDataSource.updateUser(userModel);
      await localDataSource.cacheUser(updatedUser);
      return Right(updatedUser);
    } on ServerException catch (e) {
      return Left(ServerFailure(e.message));
    }
  }

  @override
  Future<Either<Failure, void>> deleteUser(String userId) async {
    try {
      await remoteDataSource.deleteUser(userId);
      await localDataSource.clearUser(userId);
      return const Right(null);
    } on ServerException catch (e) {
      return Left(ServerFailure(e.message));
    }
  }

  @override
  Stream<User> watchUser(String userId) {
    return remoteDataSource.watchUser(userId);
  }
}</code></pre>

            <h2>Benefits of This Architecture</h2>
            <table>
                <tr><th>Benefit</th><th>Description</th><th>Example</th></tr>
                <tr>
                    <td><strong>Testability</strong></td>
                    <td>Each layer can be tested independently</td>
                    <td>Mock repository in BLoC tests</td>
                </tr>
                <tr>
                    <td><strong>Maintainability</strong></td>
                    <td>Changes are isolated to specific layers</td>
                    <td>Switch from Firebase to REST without touching domain</td>
                </tr>
                <tr>
                    <td><strong>Scalability</strong></td>
                    <td>Easy to add new features</td>
                    <td>New feature follows same pattern</td>
                </tr>
                <tr>
                    <td><strong>Framework Independence</strong></td>
                    <td>Business logic doesn't depend on Flutter</td>
                    <td>Domain layer is pure Dart</td>
                </tr>
                <tr>
                    <td><strong>Separation of Concerns</strong></td>
                    <td>Clear responsibilities for each component</td>
                    <td>BLoC handles state, Use Case handles logic</td>
                </tr>
            </table>
        

                <div class="page-navigation">
                    <a href="08-glossary.html" class="page-nav-link prev"><i class="fas fa-arrow-left"></i> Previous</a>
                    <a href="21-brand-guidelines.html" class="page-nav-link next">Next <i class="fas fa-arrow-right"></i></a>
                </div>
            </div>
        </div>
    </main>

    <script src="../js/main.js"></script>
</body>
</html>